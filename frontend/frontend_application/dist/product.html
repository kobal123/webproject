<!doctype html><html xmlns:th="http://www.thymeleaf.org"><head><meta charset="utf-8"/><link rel="icon" href="%PUBLIC_URL%/favicon.ico"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#000000"/><meta name="description" content="Web site created using create-react-app"/><link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png"/><link rel="manifest" href="%PUBLIC_URL%/manifest.json"/><title>React App</title><script defer="defer" src="/product.js"></script><link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous"><link href="https://getbootstrap.com/docs/4.0/examples/signin/signin.css" rel="stylesheet" crossorigin="anonymous"/><link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><meta th:name="_csrf" th:content="${_csrf.token}"/><meta th:name="_csrf_header" th:content="${_csrf.headerName}"/><style>#root{
      height: 8em;
      width: 8em;
    }

    .dropZoneOverlay {
            border: dotted 1px;
            
            color: #7066fb;
            top: 0px;
            text-align: center;
            
        }

        .FileUpload {
            opacity: 0;
            position: relative;
            z-index: 1;
            cursor: pointer;
          }</style><script defer="defer" src="product.js"></script></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div th:replace="test.html :: sidebar"></div><div th:replace="test.html :: header"></div><div class="container"><div id="root"></div><h1>Sign up</h1><form action="http://localhost:8080/products/add" th:object="${productForm}" method="post" enctype="multipart/form-data"><input th:field="*{name}"/> <input th:field="*{price}"/> <input th:field="*{Quantity}"/> <input type="file" name="file" accept=".jpg,.png,.gif"/> <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/> <input type="submit" value="Termék létrehozása form submittel"/></form><button id="btn" class="btn btn-lg btn-primary btn-block" onclick="sendTokenToServer()">Termék létrehozása AJAX hívással</button> <input type="file" id="drop_zone" class="FileUpload" accept=".jpg,.png,.gif"/></div><script>function sendTokenToServer(){
      let formdata = new FormData();


      let f = document.getElementById("drop_zone")

      console.log("the following come from custom dropzone")
      console.log(f.files)


      formdata.append("file",f.files[0])
      console.log(document.cookie)

      let token = document.querySelector('meta[name="_csrf"]').content;
      let header = document.querySelector('meta[name="_csrf_header"]').content;

      console.log("data: "+token+" header: "+header);

      var request = new XMLHttpRequest();
      request.open("POST", "http://localhost:8080/products/add");
      request.setRequestHeader(header,token);

      request.send(formdata);

    }</script></body></html>